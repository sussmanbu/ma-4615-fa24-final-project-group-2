{
  "hash": "d2b8bc1d0d8bc13328c39bf084a3d123",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Fifth Post\"\nauthor: \"Group 2\"\nformat: html\neditor: visual\ndescription: \"This post details our incorportation of other data\"\ndate: \"2024-11-11\"\n---\n\n\nFinding and implementing another dataset:\n\nhttps://www.kaggle.com/datasets/asaniczka/san-francisco-police-stop-data-2018-2023\nThis dataset sourced from kaggle, contains detailed records of the police stops conducted in San Francisco over the last 5 years. It includes information such as the location, reason for stop and races that we need to make the comparative analysis.\n\nThe entire database containing traffic data for all regions across the nation can be found here:\nhttps://openpolicing.stanford.edu/data/\n\nTo incorporate a wider range of data for the purpose of our study, we wanted to bring in traffic stop data from other locations beyond Rhode Island. By looking at traffic data from other states across the country, we can see whether the trends observed in Rhode Island are specific to the area or not. To this end, we will incorporate a similar police stop data set, this time from San Francisco. Studying a dataset from California will allow us to compare East Coast trends against West Coast trends. \n\nAlthough the dataset is similar in format to the Rhode Island one (being sourced from the same Stanford Policing Project) it will require a significant amount of cleaning to be utilized for several reasons. First, the San Francisco data lists the stop duration variable as a continuous numeric value, recording the precise duration of the stop instead of discrete bins as in the Rhode Island data. In addition, the San Francisco data includes a numeric code for their categorical variables such as ‘action taken,’ ‘reason for stop’ and ‘result of stop.’ We will need to do significant translating of the row values, column names, and column types in order to make the two datasets compatible with each other. \n\nHere is what the raw dataset looks like:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreadRDS(here::here(\"dataset\", \"sf_raw_dataset.rds\"))|>\n  head(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   raw_row_number       date      time                  location      lat\n1          869921 2014-08-01   60 secs      MASONIC AV & FELL ST 37.77300\n2          869922 2014-08-01   60 secs             GEARY&10TH AV 37.78090\n3          869923 2014-08-01  900 secs       SUTTER N OCTAVIA ST 37.78692\n4          869924 2014-08-01 1080 secs         3RD ST & DAVIDSON 37.74638\n5          869925 2014-08-01 1140 secs DIVISADERO ST. & BUSH ST. 37.78635\n6          869926 2014-08-01 1800 secs     3RD ST AND GALVEZ AVE 37.74108\n7          869927 2014-08-01 1800 secs     COLUMBUS AND BROADWAY 37.79787\n8          869928 2014-08-01 2100 secs         INGALLS & QUESADA 37.72912\n9          869929 2014-08-01 3600 secs       17TH ST & BRYANT ST 37.76432\n10         869930 2014-08-01 3600 secs  FULTON ST. & FUNSTON AV. 37.77317\n         lng district subject_age           subject_race subject_sex      type\n1  -122.4459     <NA>          NA asian/pacific islander      female vehicular\n2  -122.4686     <NA>          NA                  black        male vehicular\n3  -122.4267     <NA>          NA               hispanic        male vehicular\n4  -122.3920     <NA>          NA               hispanic        male vehicular\n5  -122.4400     <NA>          NA                  white        male vehicular\n6  -122.3884     <NA>          NA                  black        male vehicular\n7  -122.4067     <NA>          NA               hispanic        male vehicular\n8  -122.3840     <NA>          NA                  black      female vehicular\n9  -122.4104     <NA>          NA                  black        male vehicular\n10 -122.4713     <NA>          NA                  white      female vehicular\n   arrest_made citation_issued warning_issued  outcome contraband_found\n1        FALSE           FALSE           TRUE  warning               NA\n2        FALSE            TRUE          FALSE citation               NA\n3        FALSE            TRUE          FALSE citation               NA\n4        FALSE           FALSE           TRUE  warning               NA\n5        FALSE            TRUE          FALSE citation               NA\n6        FALSE            TRUE          FALSE citation               NA\n7        FALSE            TRUE          FALSE citation               NA\n8        FALSE            TRUE          FALSE citation               NA\n9        FALSE            TRUE          FALSE citation               NA\n10       FALSE            TRUE          FALSE citation               NA\n   search_conducted search_vehicle search_basis\n1             FALSE          FALSE         <NA>\n2             FALSE          FALSE         <NA>\n3             FALSE          FALSE         <NA>\n4             FALSE          FALSE         <NA>\n5             FALSE          FALSE         <NA>\n6             FALSE          FALSE         <NA>\n7             FALSE          FALSE         <NA>\n8             FALSE          FALSE         <NA>\n9             FALSE          FALSE         <NA>\n10            FALSE          FALSE         <NA>\n                             reason_for_stop raw_search_vehicle_description\n1  Mechanical or Non-Moving Violation (V.C.)                      No Search\n2  Mechanical or Non-Moving Violation (V.C.)                      No Search\n3  Mechanical or Non-Moving Violation (V.C.)                      No Search\n4  Mechanical or Non-Moving Violation (V.C.)                      No Search\n5  Mechanical or Non-Moving Violation (V.C.)                      No Search\n6  Mechanical or Non-Moving Violation (V.C.)                      No Search\n7                           Moving Violation                      No Search\n8  Mechanical or Non-Moving Violation (V.C.)                      No Search\n9  Mechanical or Non-Moving Violation (V.C.)                      No Search\n10                          Moving Violation                      No Search\n   raw_result_of_contact_description\n1                            Warning\n2                           Citation\n3                           Citation\n4                            Warning\n5                           Citation\n6                           Citation\n7                           Citation\n8                           Citation\n9                           Citation\n10                          Citation\n```\n\n\n:::\n:::\n\n\nSo far, our work to implement the SF data set into our RI one can be found in `scripts/load_and_clean_data2`. A preview of the code can be found below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n# Load data\nri_traffic_data_clean <- readRDS(here::here(\"dataset\", \"cleaned_dataset.rds\"))\nsf_traffic_data <- readRDS(here::here(\"dataset\", \"sf_raw_dataset.rds\"))\n\n# variables in RI data\n# stop_date, stop_time, driver_gender, driver_race, violation_raw, violation\n# search_conducted, search_type, stop_outcome, is_arrested, stop_duration\n# drugs_related_stop, district\n\nri_traffic_data_clean = ri_traffic_data_clean|>\n  mutate(state = \"Rhode Island\",\n         driver_race = tolower(driver_race))\n\n# omitted columns are already in the dataset correctly labeled\nsf_traffic_data_clean = sf_traffic_data|>\n  filter(!is.na(subject_sex) | \n         !is.na(subject_race))|>\n  mutate(state = \"California\",\n         stop_date = date,\n         stop_time = time,\n         driver_gender = if_else(subject_sex == 'male', 'M', 'F'),\n         driver_race = if_else(subject_race == 'asian/pacific islander', 'asian', subject_race),\n         violation_raw = NULL, # differing values\n         violation = NULL, # differing values\n         search_type = NULL, # not included\n         stop_outcome = NULL, # differing values\n         is_arrested = arrest_made,\n         stop_duration = NULL, # not included,\n         drugs_related_stop = NULL, # not included,\n         )\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}