---
title: "Sixth Post"
author: "Group 2"
format: html
editor: visual
description: "This post details our EDA of San Fransicso data"
date: "2024-11-18"
---

This week we finished implementing the data from San Francisco into our data set. In addition, we performed preliminary EDA on the San Francisco data by implementing the visualization and modeling methods used earlier. The complete data set with both the SF and RI data is generated through `"load_and_clean_data2.R"`

```{r}
source("scripts/load_and_clean_data2.R")

full_traffic_data_clean|>
  head(10)

```

Below, you can see our code for modeling the likelihood of arrest by certain factors for our SF data alone. We can observe a noticeable difference in this model’s performance compared to the RI model; Race does not play as significant a role in predicting the probability of arrest here.

```{r}
model <- glm(is_arrested ~ driver_race + driver_gender + stop_date + district,
             data = sf_traffic_data_clean, 
             family = binomial)
summary(model)
exp(coef(model))
```

**Findings:**

1.  Intercept: the positive coefficient of the intencept(6.772e-01) suggests that when all other predictors are at their baseline, the log-odds of an arrest are positive, implying a higher baseline probability of arrest.

2.  Driver_race: The coefficient (1.457e-02, p = 0.0321) indicates a weak but statistically significant positive association between race as a factor and the likelihood of arrest.

3.  Driver_gender: The coefficient (-4.527e-01, p \< 0.001) for driver_gender suggests a statistically significant negative relationship between being female and the likelihood of arrest, meaning male drivers have higher odds of being arrested. 

4.  Stop_dates: The coefficient (-3.312e-04, p \< 0.001) indicates a very small but statistically significant decrease in the likelihood of arrest over time. 

5.  District: The coefficient (7.004e-03, p = 0.0409) suggests a significant positive association between district variations and the likelihood of arrest. 

**Statistical Significance:**

The model's p-values show that most predictors are statistically significant (p \< 0.05), indicating they have significant relationships with the likelihood of arrest. 

**Model Performance:**

-   AIC (115620): The Akaike Information Criterion (AIC) suggests a reasonably good fit for the data, with lower values indicating better model performance. 

-   Residual Deviance (115610) vs. Null Deviance (117053): The reduction in deviance highlights the model's ability to explain variance in the response variable compared to an intercept-only model.

**Interpretation:**

The analysis underscores the role of race, gender, and geographic location in predicting arrest probability, with significant contributions from male gender and specific districts. The trends in stop_date further highlight potential temporal patterns in arrests. While the model fits the data well, disparities in predictive factors warrant further investigation.

Below are some graphs to visualize the raw San Francisco data. As seen below, this data includes a much larger proportion of black and hispanic drivers compared to the RI data, and Blacks seem to be given warnings with a slightly higher proportion than other races:

```{r}
arrest_rates <- sf_traffic_data_clean %>%
  group_by(driver_race) %>%
  summarize(arrest_rate = mean(is_arrested, na.rm = TRUE)) 

ggplot(arrest_rates, aes(x = factor(driver_race), y = arrest_rate, fill = factor(driver_race))) +
  geom_bar(stat = "identity") +
  labs(title = "Arrest Rate by Race", x = "Race", y = "Arrest Rate") +
  scale_y_continuous(labels = scales::percent) +    theme_minimal()

race_stop_counts <- sf_traffic_data %>%
  count(subject_race, raw_result_of_contact_description)

ggplot(race_stop_counts, aes(x = factor(subject_race), y = n, fill = raw_result_of_contact_description)) +
  geom_bar(stat = "identity", position = "fill") + 
  labs(title = "Distribution of Stop Results by Race", x = "Race", y = "Proportion") +
  scale_y_continuous(labels = scales::percent) + theme_minimal()

```
